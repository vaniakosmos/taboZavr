(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const theme_1 = require("./theme");
const ui_1 = require("./ui");
const search_1 = require("./search");
const tabs_1 = require("./tabs");
const utils_1 = require("./utils");
const logger = new utils_1.Logger('app');
logger.log('inside');
theme_1.default.load().then(function (theme) {
    logger.log(theme);
    // applyTheme(theme)
});
ui_1.setUpNavUrls();
search_1.setUpSearch({
    def: 'google',
    engines: [{
        name: 'google',
        url: 'http://google.com/search?q='
    }, {
        name: 'images',
        url: 'https://www.google.com/images?q='
    }, {
        name: 'trakt',
        url: 'http://trakt.tv/search?q='
    }],
    labelIsUrl: false
});
tabs_1.setUpTabs({
    def: 'fav',
    grid: {
        cols: 5,
        rows: 5
    },
    entities: [{
        name: 'Fav',
        src: 'bookmark:Bookmarks Bar'
    }, {
        name: 'Top',
        src: 'top'
    }, {
        name: 'Recent',
        src: 'recent'
    }, {
        name: 'ner',
        src: 'bookmark:Other Bookmarks/ner'
    }]
});

},{"./search":2,"./tabs":3,"./theme":4,"./ui":5,"./utils":6}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
function setUpEngines(engines, def) {
    const $enginesForm = $('#engines');
    const $source = $("#engine-template").html();
    const engineTemplate = Handlebars.compile($source);
    const $engines = [];
    engines.forEach(function (engine) {
        const $engine = $(engineTemplate({
            name: engine.name,
            url: engine.url,
            checked: engine.name === def
        }));
        $engines.push($engine.find('input'));
        $enginesForm.append($engine);
    });
    return $engines;
}
function setUpSearch(searchOptions) {
    const $searchInput = $('#search');
    const $searchButton = $('#search-btn');
    const engines = searchOptions.engines;
    const $engineInputs = setUpEngines(engines, searchOptions.def);
    function doSearch(url = 'http://google.com/search?q=') {
        let query = $searchInput.val();
        for (let $engineInput of $engineInputs) {
            if ($engineInput.prop('checked')) {
                url = $engineInput.attr('data-url');
                break;
            }
        }
        if (query) {
            const destUrl = url + encodeURIComponent(query);
            chrome.tabs.getCurrent(function (tab) {
                chrome.tabs.update(tab.id, {
                    url: destUrl
                });
            });
        }
    }
    $engineInputs.forEach(function ($engineInput) {
        $engineInput.click(function () {
            $searchInput.focus();
            if (searchOptions.labelIsUrl) doSearch($engineInput.attr('data-url'));
        });
    });
    $searchInput.on('keypress', e => {
        if (e.keyCode === 13) {
            e.preventDefault();
            doSearch();
        }
    });
    $searchButton.click(() => {
        doSearch();
    });
}
exports.setUpSearch = setUpSearch;

},{}],3:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("./utils");
const tileTemplate = Handlebars.compile($("#tile-template").html());
const headerTemplate = Handlebars.compile($("#tab-title-template").html());
function setUpTabs(tabs) {
    const $tabs = $('#tabs');
    const $headers = $tabs.find('ul').eq(0);
    const $contents = $tabs.find('ul').eq(1);
    for (let tab of tabs.entities) {
        const header = headerTemplate({
            name: tab.name,
            active: tab.name.toLowerCase() === tabs.def.toLowerCase()
        });
        $headers.append(header);
        const $content = $('<li>');
        $contents.append($content);
        if (tab.src === 'top') {
            setUpTop($content, tabs.grid);
        } else if (tab.src === 'recent') {
            setUpRecent($content, tabs.grid);
        } else {
            setUpBookmarks(tab, $content, tabs.grid);
        }
    }
}
exports.setUpTabs = setUpTabs;
function addTile($content, data) {
    const $tile = $(tileTemplate({
        favicon: `chrome://favicon/size/16@2x/${data.url}`,
        title: data.title,
        url: decodeURIComponent(data.url)
    }));
    if (data.url.startsWith('chrome')) {
        $tile.click(utils_1.openLinkFunc(data.url));
    }
    $content.append($tile);
}
function traverse(tree, path) {
    if (path.length === 0) return tree;
    for (let child of tree.children) {
        if (child.title === path[0]) {
            path = path.slice(1);
            return traverse(child, path);
        }
    }
    return null;
}
function setUpTop($content, { rows, cols }) {
    chrome.topSites.get(function (urls) {
        for (let i = 0; i < urls.length && i < rows * cols; i++) {
            addTile($content, urls[i]);
        }
    });
}
function setUpRecent($content, { rows, cols }) {
    chrome.sessions.getRecentlyClosed(function (sessions) {
        for (let i = 0; i < sessions.length && i < rows * cols; i++) {
            if (sessions[i].tab) addTile($content, sessions[i].tab);
        }
    });
}
function setUpBookmarks(tab, $content, { rows, cols }) {
    if (!tab.src.startsWith('bookmark:')) return;
    const path = tab.src.replace(/^bookmark:/, '').split('/');
    console.log('path', path);
    chrome.bookmarks.getTree(function (tree) {
        const bookmarkTree = tree[0];
        const folder = traverse(bookmarkTree, path);
        if (folder) {
            for (let i = 0; i < folder.children.length && i < rows * cols; i++) {
                const bookmark = folder.children[i];
                if (!bookmark.children) {
                    addTile($content, bookmark);
                }
            }
        }
        console.log('folder', folder);
    });
}

},{"./utils":6}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("./utils");
const logger = new utils_1.Logger('theme');
let theme = {
    isImage: false,
    title: 'New Tab',
    header: {
        value: 'Search',
        size: 60,
        hide: false
    },
    accent: 'rgb(255, 66, 66)',
    background: 'rgb(222, 222, 222)'
};
exports.default = {
    get() {
        return theme;
    },
    remove() {
        return new Promise(resolve => {
            chrome.storage.sync.remove('theme', function () {
                logger.log('removed from storage');
                resolve(theme);
            });
        });
    },
    load() {
        return new Promise(resolve => {
            chrome.storage.sync.get('theme', function (result) {
                if (result.theme) {
                    logger.log('using loaded from storage');
                    theme = result.theme;
                    resolve(theme);
                } else {
                    chrome.storage.sync.set({ 'theme': theme }, function () {
                        logger.log(`using default and save into storage`);
                        resolve(theme);
                    });
                }
            });
        });
    },
    save() {
        return new Promise(resolve => {
            chrome.storage.sync.set({ 'theme': theme }, function () {
                logger.log('saved');
                resolve();
            });
        });
    }
};

},{"./utils":6}],5:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const utils_1 = require("./utils");
const logger = new utils_1.Logger('ui');
function applyTheme(theme) {
    // title
    document.title = theme.title;
    // header
    const $title = $("#title");
    const header = theme.header;
    if (header.hide) {
        $title.hide();
    } else {
        $title.html(header.value).css('font-size', header.size);
    }
    if (theme.isImage) {
        // image
    } else {
        // background
        $('body').css('background', theme.background);
    }
    // accent
    $('.accent').css('background', theme.accent);
}
exports.applyTheme = applyTheme;
function setUpNavUrls() {
    $('#history').click(utils_1.openLinkFunc('chrome://history/'));
    $('#bookmarks').click(utils_1.openLinkFunc('chrome://bookmarks/'));
    $('#extensions').click(utils_1.openLinkFunc('chrome://extensions/'));
    $('#all-apps').click(utils_1.openLinkFunc('chrome://apps/'));
    setUpAddons();
}
exports.setUpNavUrls = setUpNavUrls;
function setUpAddons() {
    const $source = $("#app-template").html();
    const appTemplate = Handlebars.compile($source);
    chrome.management.getAll(function (addons) {
        const $apps_list = $('#apps');
        for (let addon of addons) {
            if (addon.type.endsWith('_app')) {
                let icon = '';
                if (addon.icons) {
                    icon = addon.icons[addon.icons.length - 1].url;
                }
                const appHtml = appTemplate({
                    name: addon.name,
                    icon: icon
                });
                const $clickableApp = $(appHtml).click(() => chrome.management.launchApp(addon.id));
                $apps_list.append($clickableApp);
            }
        }
    });
}

},{"./utils":6}],6:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
class Logger {
    constructor(name) {
        this.name = name.toUpperCase();
    }
    log(...message) {
        console.log(this.name + ':', ...message);
    }
    error(...message) {
        console.error(this.name + ':', ...message);
    }
}
exports.Logger = Logger;
function openLinkFunc(url) {
    return function (event) {
        if (event.ctrlKey || event.shiftKey || event.metaKey || event.button && event.button === 1) {
            chrome.tabs.create({ url: url, active: false });
        } else {
            chrome.tabs.getCurrent(function (tab) {
                chrome.tabs.update(tab.id, { url: url });
            });
        }
    };
}
exports.openLinkFunc = openLinkFunc;
class Color {
    constructor(r, g, b, a) {
        [this.r, this.g, this.b] = [r, g, b];
        if (a) this.a = a;
    }
    static isBound(n) {
        return n >= 0 && n <= 255;
    }
    valid() {
        const a = this.a || 0;
        const isBoundA = Color.isBound(a);
        return Color.isBound(this.r) && Color.isBound(this.g) && Color.isBound(this.b) && isBoundA;
    }
    toString() {
        // return "rgb(1,1,1)";
        if (this.a) return `rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`;
        return `rgb(${this.r}, ${this.g}, ${this.b})`;
    }
}
exports.Color = Color;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvdHMvYXBwLnRzIiwic3JjL3RzL3NlYXJjaC50cyIsInNyYy90cy90YWJzLnRzIiwic3JjL3RzL3RoZW1lLnRzIiwic3JjL3RzL3VpLnRzIiwic3JjL3RzL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FDQUEsd0JBQTRCO0FBQzVCLHFCQUE2QztBQUM3Qyx5QkFBb0M7QUFDcEMsdUJBQWdDO0FBQ2hDLHdCQUE4QjtBQUc5QixNQUFNLEFBQU0sU0FBRyxJQUFJLFFBQU0sT0FBQyxBQUFLLEFBQUMsQUFBQztBQUNqQyxBQUFNLE9BQUMsQUFBRyxJQUFDLEFBQVEsQUFBQyxBQUFDO0FBRXJCLFFBQU0sUUFBQyxBQUFJLEFBQUUsT0FHUixBQUFJLEtBQUMsVUFBVSxBQUFLO0FBQ2pCLEFBQU0sV0FBQyxBQUFHLElBQUMsQUFBSyxBQUFDLEFBQUM7QUFDbEIsQUFBb0IsQUFDeEI7QUFBQyxBQUFDLEFBQUM7QUFFUCxLQUFZLEFBQUUsQUFBQztBQUVmLFNBQVc7QUFDUCxBQUFHLFNBQUUsQUFBUTtBQUNiLEFBQU87QUFFQyxBQUFJLGNBQUUsQUFBUTtBQUNkLEFBQUcsYUFBRSxBQUE2QixBQUNyQztBQUhELEtBREs7QUFNRCxBQUFJLGNBQUUsQUFBUTtBQUNkLEFBQUcsYUFBRSxBQUFrQyxBQUMxQztBQUhEO0FBS0ksQUFBSSxjQUFFLEFBQU87QUFDYixBQUFHLGFBQUUsQUFBMkIsQUFDbkMsQUFDSjtBQUpHO0FBS0osQUFBVSxnQkFBRSxBQUFLLEFBQ3BCLEFBQUMsQUFBQztBQWpCUztBQW1CWixPQUFTO0FBQ0wsQUFBRyxTQUFFLEFBQUs7QUFDVixBQUFJO0FBQ0EsQUFBSSxjQUFFLEFBQUM7QUFDUCxBQUFJLGNBQUUsQUFBQyxBQUNWO0FBSEs7QUFJTixBQUFRO0FBRUEsQUFBSSxjQUFFLEFBQUs7QUFDWCxBQUFHLGFBQUUsQUFBd0IsQUFFaEM7QUFK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QUMsQUFBQyxBQUFDO0FBQ3JDLEFBQUUsQUFBQyxZQUFDLEFBQUMsQUFBQyxHQUFDLEFBQUksS0FBQyxBQUFDLElBQUcsQUFBQyxBQUFDLEFBQ3RCO0FBQUM7QUFDRCxBQUFNLFdBQUMsQUFBTyxRQUFDLEFBQVM7QUFDcEIsQUFBTSxlQUFDLEFBQUMsS0FBSSxBQUFDLEtBQUksQUFBQyxLQUFJLEFBQUcsQUFBQyxBQUM5QjtBQUFDO0FBQ0QsQUFBSztBQUNELGNBQU0sQUFBQyxJQUFHLEFBQUksS0FBQyxBQUFDLEtBQUksQUFBQyxBQUFDO0FBQ3RCLGNBQU0sQUFBUSxXQUFHLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBQyxBQUFDLEFBQUM7QUFDbEMsQUFBTSxlQUFDLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBSSxLQUFDLEFBQUMsQUFBQyxNQUFJLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBSSxLQUFDLEFBQUMsQUFBQyxNQUFJLEFBQUssTUFBQyxBQUFPLFFBQUMsQUFBSSxLQUFDLEFBQUMsQUFBQyxNQUFJLEFBQVEsQUFBQyxBQUMvRjtBQUFDO0FBQ0QsQUFBUTtBQUNKLEFBQXVCO0FBQ3ZCLEFBQUUsQUFBQyxZQUFDLEFBQUksS0FBQyxBQUFDLEFBQUMsR0FDUCxBQUFNLEFBQUMsZUFBUSxBQUFJLEtBQUMsQUFBQyxNQUFLLEFBQUksS0FBQyxBQUFDLE1BQUssQUFBSSxLQUFDLEFBQUMsTUFBSyxBQUFJLEtBQUMsQUFBQyxDQUFHLEFBQUM7QUFDOUQsQUFBTSxBQUFDLHNCQUFPLEFBQUksS0FBQyxBQUFDLE1BQUssQUFBSSxLQUFDLEFBQUMsTUFBSyxBQUFJLEtBQUMsQUFBQyxDQUFHLEFBQ2pEO0FBQUMsQUFDSjs7QUF2QkQsZ0JBdUJDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImltcG9ydCB0aGVtZXIgZnJvbSAnLi90aGVtZSdcbmltcG9ydCB7YXBwbHlUaGVtZSwgc2V0VXBOYXZVcmxzfSBmcm9tICcuL3VpJ1xuaW1wb3J0IHtzZXRVcFNlYXJjaH0gZnJvbSAnLi9zZWFyY2gnXG5pbXBvcnQge3NldFVwVGFic30gZnJvbSAnLi90YWJzJ1xuaW1wb3J0IHtMb2dnZXJ9IGZyb20gJy4vdXRpbHMnXG5cblxuY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcignYXBwJyk7XG5sb2dnZXIubG9nKCdpbnNpZGUnKTtcblxudGhlbWVyLmxvYWQoKVxuICAgIC8vIC50aGVuKCgpID0+IHRoZW1lci5zYXZlKCkpXG4gICAgLy8gLnRoZW4oKCkgPT4gdGhlbWVyLmxvYWQoKSlcbiAgICAudGhlbihmdW5jdGlvbiAodGhlbWUpIHtcbiAgICAgICAgbG9nZ2VyLmxvZyh0aGVtZSk7XG4gICAgICAgIC8vIGFwcGx5VGhlbWUodGhlbWUpXG4gICAgfSk7XG5cbnNldFVwTmF2VXJscygpO1xuXG5zZXRVcFNlYXJjaCh7XG4gICAgZGVmOiAnZ29vZ2xlJyxcbiAgICBlbmdpbmVzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdnb29nbGUnLFxuICAgICAgICAgICAgdXJsOiAnaHR0cDovL2dvb2dsZS5jb20vc2VhcmNoP3E9JyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ2ltYWdlcycsXG4gICAgICAgICAgICB1cmw6ICdodHRwczovL3d3dy5nb29nbGUuY29tL2ltYWdlcz9xPScsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICd0cmFrdCcsXG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vdHJha3QudHYvc2VhcmNoP3E9JyxcbiAgICAgICAgfSxcbiAgICBdLFxuICAgIGxhYmVsSXNVcmw6IGZhbHNlLFxufSk7XG5cbnNldFVwVGFicyh7XG4gICAgZGVmOiAnZmF2JyxcbiAgICBncmlkOiB7XG4gICAgICAgIGNvbHM6IDUsXG4gICAgICAgIHJvd3M6IDUsXG4gICAgfSxcbiAgICBlbnRpdGllczogW1xuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnRmF2JyxcbiAgICAgICAgICAgIHNyYzogJ2Jvb2ttYXJrOkJvb2ttYXJrcyBCYXInLFxuXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6ICdUb3AnLFxuICAgICAgICAgICAgc3JjOiAndG9wJyxcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogJ1JlY2VudCcsXG4gICAgICAgICAgICBzcmM6ICdyZWNlbnQnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBuYW1lOiAnbmVyJyxcbiAgICAgICAgICAgIHNyYzogJ2Jvb2ttYXJrOk90aGVyIEJvb2ttYXJrcy9uZXInLFxuICAgICAgICB9LFxuICAgIF0sXG59KTtcbiIsImltcG9ydCB7RW5naW5lLCBTZWFyY2h9IGZyb20gXCIuL3R5cGVzXCI7XG5cblxuZnVuY3Rpb24gc2V0VXBFbmdpbmVzKGVuZ2luZXM6IEFycmF5PEVuZ2luZT4sIGRlZjogc3RyaW5nKTogSlF1ZXJ5W10ge1xuICAgIGNvbnN0ICRlbmdpbmVzRm9ybSA9ICQoJyNlbmdpbmVzJyk7XG4gICAgY29uc3QgJHNvdXJjZSA9ICQoXCIjZW5naW5lLXRlbXBsYXRlXCIpLmh0bWwoKTtcbiAgICBjb25zdCBlbmdpbmVUZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZSgkc291cmNlKTtcbiAgICBjb25zdCAkZW5naW5lcyA9IFtdO1xuICAgIGVuZ2luZXMuZm9yRWFjaChmdW5jdGlvbiAoZW5naW5lKSB7XG4gICAgICAgIGNvbnN0ICRlbmdpbmUgPSAkKGVuZ2luZVRlbXBsYXRlKHtcbiAgICAgICAgICAgIG5hbWU6IGVuZ2luZS5uYW1lLFxuICAgICAgICAgICAgdXJsOiBlbmdpbmUudXJsLFxuICAgICAgICAgICAgY2hlY2tlZDogZW5naW5lLm5hbWUgPT09IGRlZixcbiAgICAgICAgfSkpO1xuICAgICAgICAkZW5naW5lcy5wdXNoKCRlbmdpbmUuZmluZCgnaW5wdXQnKSk7XG4gICAgICAgICRlbmdpbmVzRm9ybS5hcHBlbmQoJGVuZ2luZSlcbiAgICB9KTtcbiAgICByZXR1cm4gJGVuZ2luZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRVcFNlYXJjaChzZWFyY2hPcHRpb25zOiBTZWFyY2gpIHtcbiAgICBjb25zdCAkc2VhcmNoSW5wdXQgPSAkKCcjc2VhcmNoJyk7XG4gICAgY29uc3QgJHNlYXJjaEJ1dHRvbiA9ICQoJyNzZWFyY2gtYnRuJyk7XG4gICAgY29uc3QgZW5naW5lcyA9IHNlYXJjaE9wdGlvbnMuZW5naW5lcztcbiAgICBjb25zdCAkZW5naW5lSW5wdXRzID0gc2V0VXBFbmdpbmVzKGVuZ2luZXMsIHNlYXJjaE9wdGlvbnMuZGVmKTtcblxuICAgIGZ1bmN0aW9uIGRvU2VhcmNoKHVybCA9ICdodHRwOi8vZ29vZ2xlLmNvbS9zZWFyY2g/cT0nKSB7XG4gICAgICAgIGxldCBxdWVyeSA9ICRzZWFyY2hJbnB1dC52YWwoKTtcbiAgICAgICAgZm9yIChsZXQgJGVuZ2luZUlucHV0IG9mICRlbmdpbmVJbnB1dHMpIHtcbiAgICAgICAgICAgIGlmICgkZW5naW5lSW5wdXQucHJvcCgnY2hlY2tlZCcpKSB7XG4gICAgICAgICAgICAgICAgdXJsID0gJGVuZ2luZUlucHV0LmF0dHIoJ2RhdGEtdXJsJyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHF1ZXJ5KSB7XG4gICAgICAgICAgICBjb25zdCBkZXN0VXJsID0gdXJsICsgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5IGFzIHN0cmluZyk7XG4gICAgICAgICAgICBjaHJvbWUudGFicy5nZXRDdXJyZW50KGZ1bmN0aW9uICh0YWIpIHtcbiAgICAgICAgICAgICAgICBjaHJvbWUudGFicy51cGRhdGUodGFiLmlkLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogZGVzdFVybCxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJGVuZ2luZUlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uICgkZW5naW5lSW5wdXQpIHtcbiAgICAgICAgJGVuZ2luZUlucHV0LmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzZWFyY2hJbnB1dC5mb2N1cygpO1xuICAgICAgICAgICAgaWYgKHNlYXJjaE9wdGlvbnMubGFiZWxJc1VybClcbiAgICAgICAgICAgICAgICBkb1NlYXJjaCgkZW5naW5lSW5wdXQuYXR0cignZGF0YS11cmwnKSk7XG4gICAgICAgIH0pXG4gICAgfSk7XG5cbiAgICAkc2VhcmNoSW5wdXQub24oJ2tleXByZXNzJywgZSA9PiB7XG4gICAgICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBkb1NlYXJjaCgpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgJHNlYXJjaEJ1dHRvbi5jbGljaygoKSA9PiB7XG4gICAgICAgIGRvU2VhcmNoKCk7XG4gICAgfSk7XG59XG4iLCJpbXBvcnQge1RhYiwgVGFic30gZnJvbSBcIi4vdHlwZXNcIjtcbmltcG9ydCB7b3BlbkxpbmtGdW5jfSBmcm9tIFwiLi91dGlsc1wiO1xuaW1wb3J0IEJvb2ttYXJrVHJlZU5vZGUgPSBjaHJvbWUuYm9va21hcmtzLkJvb2ttYXJrVHJlZU5vZGU7XG5cbmludGVyZmFjZSBUaXRsZVVybCB7XG4gICAgdGl0bGU6IHN0cmluZyxcbiAgICB1cmw6IHN0cmluZ1xufVxuXG5jb25zdCB0aWxlVGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoJChcIiN0aWxlLXRlbXBsYXRlXCIpLmh0bWwoKSk7XG5jb25zdCBoZWFkZXJUZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZSgkKFwiI3RhYi10aXRsZS10ZW1wbGF0ZVwiKS5odG1sKCkpO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRVcFRhYnModGFiczogVGFicykge1xuICAgIGNvbnN0ICR0YWJzID0gJCgnI3RhYnMnKTtcbiAgICBjb25zdCAkaGVhZGVycyA9ICR0YWJzLmZpbmQoJ3VsJykuZXEoMCk7XG4gICAgY29uc3QgJGNvbnRlbnRzID0gJHRhYnMuZmluZCgndWwnKS5lcSgxKTtcblxuXG4gICAgZm9yIChsZXQgdGFiIG9mIHRhYnMuZW50aXRpZXMpIHtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gaGVhZGVyVGVtcGxhdGUoe1xuICAgICAgICAgICAgbmFtZTogdGFiLm5hbWUsXG4gICAgICAgICAgICBhY3RpdmU6IHRhYi5uYW1lLnRvTG93ZXJDYXNlKCkgPT09IHRhYnMuZGVmLnRvTG93ZXJDYXNlKCksXG4gICAgICAgIH0pO1xuICAgICAgICAkaGVhZGVycy5hcHBlbmQoaGVhZGVyKTtcbiAgICAgICAgY29uc3QgJGNvbnRlbnQgPSAkKCc8bGk+Jyk7XG4gICAgICAgICRjb250ZW50cy5hcHBlbmQoJGNvbnRlbnQpO1xuXG4gICAgICAgIGlmICh0YWIuc3JjID09PSAndG9wJykge1xuICAgICAgICAgICAgc2V0VXBUb3AoJGNvbnRlbnQsIHRhYnMuZ3JpZClcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0YWIuc3JjID09PSAncmVjZW50Jykge1xuICAgICAgICAgICAgc2V0VXBSZWNlbnQoJGNvbnRlbnQsIHRhYnMuZ3JpZClcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNldFVwQm9va21hcmtzKHRhYiwgJGNvbnRlbnQsIHRhYnMuZ3JpZCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGFkZFRpbGUoJGNvbnRlbnQ6IEpRdWVyeSwgZGF0YTogVGl0bGVVcmwpIHtcbiAgICBjb25zdCAkdGlsZSA9ICQodGlsZVRlbXBsYXRlKHtcbiAgICAgICAgZmF2aWNvbjogYGNocm9tZTovL2Zhdmljb24vc2l6ZS8xNkAyeC8ke2RhdGEudXJsfWAsXG4gICAgICAgIHRpdGxlOiBkYXRhLnRpdGxlLFxuICAgICAgICB1cmw6IGRlY29kZVVSSUNvbXBvbmVudChkYXRhLnVybClcbiAgICB9KSk7XG5cbiAgICBpZiAoZGF0YS51cmwuc3RhcnRzV2l0aCgnY2hyb21lJykpIHtcbiAgICAgICAgJHRpbGUuY2xpY2sob3BlbkxpbmtGdW5jKGRhdGEudXJsKSk7XG4gICAgfVxuXG4gICAgJGNvbnRlbnQuYXBwZW5kKCR0aWxlKTtcbn1cblxuZnVuY3Rpb24gdHJhdmVyc2UodHJlZTogQm9va21hcmtUcmVlTm9kZSwgcGF0aDogc3RyaW5nW10pOiBCb29rbWFya1RyZWVOb2RlIHtcbiAgICBpZiAocGF0aC5sZW5ndGggPT09IDApXG4gICAgICAgIHJldHVybiB0cmVlO1xuICAgIGZvciAobGV0IGNoaWxkIG9mIHRyZWUuY2hpbGRyZW4pIHtcbiAgICAgICAgaWYgKGNoaWxkLnRpdGxlID09PSBwYXRoWzBdKSB7XG4gICAgICAgICAgICBwYXRoID0gcGF0aC5zbGljZSgxKTtcbiAgICAgICAgICAgIHJldHVybiB0cmF2ZXJzZShjaGlsZCwgcGF0aCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbmZ1bmN0aW9uIHNldFVwVG9wKCRjb250ZW50OiBKUXVlcnksIHtyb3dzLCBjb2xzfSkge1xuICAgIGNocm9tZS50b3BTaXRlcy5nZXQoZnVuY3Rpb24gKHVybHMpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1cmxzLmxlbmd0aCAmJiBpIDwgcm93cyAqIGNvbHM7IGkrKykge1xuICAgICAgICAgICAgYWRkVGlsZSgkY29udGVudCwgdXJsc1tpXSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc2V0VXBSZWNlbnQoJGNvbnRlbnQ6IEpRdWVyeSwge3Jvd3MsIGNvbHN9KSB7XG4gICAgY2hyb21lLnNlc3Npb25zLmdldFJlY2VudGx5Q2xvc2VkKGZ1bmN0aW9uIChzZXNzaW9ucykge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlc3Npb25zLmxlbmd0aCAmJiBpIDwgcm93cyAqIGNvbHM7IGkrKykge1xuICAgICAgICAgICAgaWYgKHNlc3Npb25zW2ldLnRhYilcbiAgICAgICAgICAgICAgICBhZGRUaWxlKCRjb250ZW50LCBzZXNzaW9uc1tpXS50YWIgYXMgVGl0bGVVcmwpO1xuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gc2V0VXBCb29rbWFya3ModGFiOiBUYWIsICRjb250ZW50OiBKUXVlcnksIHtyb3dzLCBjb2xzfSkge1xuICAgIGlmICghdGFiLnNyYy5zdGFydHNXaXRoKCdib29rbWFyazonKSkgcmV0dXJuO1xuICAgIGNvbnN0IHBhdGggPSB0YWIuc3JjLnJlcGxhY2UoL15ib29rbWFyazovLCAnJykuc3BsaXQoJy8nKTtcbiAgICBjb25zb2xlLmxvZygncGF0aCcsIHBhdGgpO1xuICAgIGNocm9tZS5ib29rbWFya3MuZ2V0VHJlZShmdW5jdGlvbiAodHJlZSkge1xuICAgICAgICBjb25zdCBib29rbWFya1RyZWUgPSB0cmVlWzBdO1xuICAgICAgICBjb25zdCBmb2xkZXIgPSB0cmF2ZXJzZShib29rbWFya1RyZWUsIHBhdGgpO1xuICAgICAgICBpZiAoZm9sZGVyKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZvbGRlci5jaGlsZHJlbi5sZW5ndGggJiYgaSA8IHJvd3MgKiBjb2xzOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBib29rbWFyayA9IGZvbGRlci5jaGlsZHJlbltpXTtcbiAgICAgICAgICAgICAgICBpZiAoIWJvb2ttYXJrLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGFkZFRpbGUoJGNvbnRlbnQsIGJvb2ttYXJrIGFzIFRpdGxlVXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5sb2coJ2ZvbGRlcicsIGZvbGRlcik7XG4gICAgfSlcbn1cbiIsImltcG9ydCB7VGhlbWV9IGZyb20gJy4vdHlwZXMnXG5pbXBvcnQge0xvZ2dlcn0gZnJvbSAnLi91dGlscydcblxuY29uc3QgbG9nZ2VyID0gbmV3IExvZ2dlcigndGhlbWUnKTtcblxubGV0IHRoZW1lOiBUaGVtZSA9IHtcbiAgICBpc0ltYWdlOiBmYWxzZSxcbiAgICB0aXRsZTogJ05ldyBUYWInLFxuICAgIGhlYWRlcjoge1xuICAgICAgICB2YWx1ZTogJ1NlYXJjaCcsXG4gICAgICAgIHNpemU6IDYwLFxuICAgICAgICBoaWRlOiBmYWxzZSxcbiAgICB9LFxuICAgIGFjY2VudDogJ3JnYigyNTUsIDY2LCA2NiknLFxuICAgIGJhY2tncm91bmQ6ICdyZ2IoMjIyLCAyMjIsIDIyMiknLFxufTtcblxuZXhwb3J0IGRlZmF1bHQge1xuICAgIGdldCgpIHtcbiAgICAgICAgcmV0dXJuIHRoZW1lO1xuICAgIH0sXG4gICAgcmVtb3ZlKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLnN5bmMucmVtb3ZlKCd0aGVtZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBsb2dnZXIubG9nKCdyZW1vdmVkIGZyb20gc3RvcmFnZScpO1xuICAgICAgICAgICAgICAgIHJlc29sdmUodGhlbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfSxcbiAgICBsb2FkKCk6IFByb21pc2U8VGhlbWU+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLmdldCgndGhlbWUnLCBmdW5jdGlvbiAocmVzdWx0OiB7dGhlbWU6IG9iamVjdH0pIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnRoZW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coJ3VzaW5nIGxvYWRlZCBmcm9tIHN0b3JhZ2UnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhlbWUgPSByZXN1bHQudGhlbWUgYXMgVGhlbWU7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhlbWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoeyd0aGVtZSc6IHRoZW1lfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nZ2VyLmxvZyhgdXNpbmcgZGVmYXVsdCBhbmQgc2F2ZSBpbnRvIHN0b3JhZ2VgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhlbWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIHNhdmUoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgY2hyb21lLnN0b3JhZ2Uuc3luYy5zZXQoeyd0aGVtZSc6IHRoZW1lfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5sb2coJ3NhdmVkJyk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgfVxufSIsImltcG9ydCB7VGhlbWV9IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQge29wZW5MaW5rRnVuYywgTG9nZ2VyfSBmcm9tICcuL3V0aWxzJ1xuaW1wb3J0IFRhYiA9IGNocm9tZS50YWJzLlRhYjtcbmltcG9ydCBDaHJvbWVTZXR0aW5nID0gY2hyb21lLnR5cGVzLkNocm9tZVNldHRpbmc7XG5cbmNvbnN0IGxvZ2dlciA9IG5ldyBMb2dnZXIoJ3VpJyk7XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBseVRoZW1lKHRoZW1lOiBUaGVtZSkge1xuICAgIC8vIHRpdGxlXG4gICAgZG9jdW1lbnQudGl0bGUgPSB0aGVtZS50aXRsZTtcblxuICAgIC8vIGhlYWRlclxuICAgIGNvbnN0ICR0aXRsZSA9ICQoXCIjdGl0bGVcIik7XG4gICAgY29uc3QgaGVhZGVyID0gdGhlbWUuaGVhZGVyO1xuICAgIGlmIChoZWFkZXIuaGlkZSkge1xuICAgICAgICAkdGl0bGUuaGlkZSgpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgJHRpdGxlXG4gICAgICAgICAgICAuaHRtbChoZWFkZXIudmFsdWUpXG4gICAgICAgICAgICAuY3NzKCdmb250LXNpemUnLCBoZWFkZXIuc2l6ZSk7XG4gICAgfVxuXG4gICAgaWYgKHRoZW1lLmlzSW1hZ2UpIHtcbiAgICAgICAgLy8gaW1hZ2VcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIC8vIGJhY2tncm91bmRcbiAgICAgICAgJCgnYm9keScpLmNzcygnYmFja2dyb3VuZCcsIHRoZW1lLmJhY2tncm91bmQpO1xuICAgIH1cblxuICAgIC8vIGFjY2VudFxuICAgICQoJy5hY2NlbnQnKS5jc3MoJ2JhY2tncm91bmQnLCB0aGVtZS5hY2NlbnQpO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBzZXRVcE5hdlVybHMoKSB7XG4gICAgJCgnI2hpc3RvcnknKS5jbGljayhvcGVuTGlua0Z1bmMoJ2Nocm9tZTovL2hpc3RvcnkvJykpO1xuICAgICQoJyNib29rbWFya3MnKS5jbGljayhvcGVuTGlua0Z1bmMoJ2Nocm9tZTovL2Jvb2ttYXJrcy8nKSk7XG4gICAgJCgnI2V4dGVuc2lvbnMnKS5jbGljayhvcGVuTGlua0Z1bmMoJ2Nocm9tZTovL2V4dGVuc2lvbnMvJykpO1xuICAgICQoJyNhbGwtYXBwcycpLmNsaWNrKG9wZW5MaW5rRnVuYygnY2hyb21lOi8vYXBwcy8nKSk7XG4gICAgc2V0VXBBZGRvbnMoKTtcbn1cblxuXG5mdW5jdGlvbiBzZXRVcEFkZG9ucygpIHtcbiAgICBjb25zdCAkc291cmNlID0gJChcIiNhcHAtdGVtcGxhdGVcIikuaHRtbCgpO1xuICAgIGNvbnN0IGFwcFRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKCRzb3VyY2UpO1xuXG4gICAgY2hyb21lLm1hbmFnZW1lbnQuZ2V0QWxsKGZ1bmN0aW9uIChhZGRvbnMpIHtcbiAgICAgICAgY29uc3QgJGFwcHNfbGlzdCA9ICQoJyNhcHBzJyk7XG4gICAgICAgIGZvciAobGV0IGFkZG9uIG9mIGFkZG9ucykge1xuICAgICAgICAgICAgaWYgKGFkZG9uLnR5cGUuZW5kc1dpdGgoJ19hcHAnKSkge1xuICAgICAgICAgICAgICAgIGxldCBpY29uID0gJyc7XG4gICAgICAgICAgICAgICAgaWYgKGFkZG9uLmljb25zKSB7XG4gICAgICAgICAgICAgICAgICAgIGljb24gPSBhZGRvbi5pY29uc1thZGRvbi5pY29ucy5sZW5ndGgtMV0udXJsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBhcHBIdG1sID0gYXBwVGVtcGxhdGUoe1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBhZGRvbi5uYW1lLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBpY29uLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0ICRjbGlja2FibGVBcHAgPSAkKGFwcEh0bWwpLmNsaWNrKCgpID0+IGNocm9tZS5tYW5hZ2VtZW50LmxhdW5jaEFwcChhZGRvbi5pZCkpO1xuICAgICAgICAgICAgICAgICRhcHBzX2xpc3QuYXBwZW5kKCRjbGlja2FibGVBcHApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG4iLCJleHBvcnQgY2xhc3MgTG9nZ2VyIHtcbiAgICBwcml2YXRlIG5hbWU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lLnRvVXBwZXJDYXNlKCk7XG4gICAgfVxuICAgIGxvZyguLi5tZXNzYWdlOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLm5hbWUgKyAnOicsIC4uLm1lc3NhZ2UpO1xuICAgIH1cbiAgICBlcnJvciguLi5tZXNzYWdlOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMubmFtZSArICc6JywgLi4ubWVzc2FnZSk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gb3BlbkxpbmtGdW5jKHVybDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQuY3RybEtleSB8fFxuICAgICAgICAgICAgZXZlbnQuc2hpZnRLZXkgfHxcbiAgICAgICAgICAgIGV2ZW50Lm1ldGFLZXkgfHwgIC8vIGNtZFxuICAgICAgICAgICAgKGV2ZW50LmJ1dHRvbiAmJiBldmVudC5idXR0b24gPT09IDEpXG4gICAgICAgICkge1xuICAgICAgICAgICAgY2hyb21lLnRhYnMuY3JlYXRlKHt1cmw6IHVybCwgYWN0aXZlOiBmYWxzZX0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY2hyb21lLnRhYnMuZ2V0Q3VycmVudChmdW5jdGlvbiAodGFiKSB7XG4gICAgICAgICAgICAgICAgY2hyb21lLnRhYnMudXBkYXRlKHRhYi5pZCwge3VybDogdXJsfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ29sb3Ige1xuICAgIHI6IG51bWJlcjtcbiAgICBnOiBudW1iZXI7XG4gICAgYjogbnVtYmVyO1xuICAgIGE6IG51bWJlcjtcbiAgICBjb25zdHJ1Y3RvcihyOiBudW1iZXIsIGc6IG51bWJlciwgYjogbnVtYmVyLCBhPzogbnVtYmVyKSB7XG4gICAgICAgIFt0aGlzLnIsIHRoaXMuZywgdGhpcy5iXSA9IFtyLCBnLCBiXTtcbiAgICAgICAgaWYgKGEpIHRoaXMuYSA9IGE7XG4gICAgfVxuICAgIHN0YXRpYyBpc0JvdW5kKG46IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbiA+PSAwICYmIG4gPD0gMjU1O1xuICAgIH1cbiAgICB2YWxpZCgpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgYSA9IHRoaXMuYSB8fCAwO1xuICAgICAgICBjb25zdCBpc0JvdW5kQSA9IENvbG9yLmlzQm91bmQoYSk7XG4gICAgICAgIHJldHVybiBDb2xvci5pc0JvdW5kKHRoaXMucikgJiYgQ29sb3IuaXNCb3VuZCh0aGlzLmcpICYmIENvbG9yLmlzQm91bmQodGhpcy5iKSAmJiBpc0JvdW5kQTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICAgICAgLy8gcmV0dXJuIFwicmdiKDEsMSwxKVwiO1xuICAgICAgICBpZiAodGhpcy5hKVxuICAgICAgICAgICAgcmV0dXJuIGByZ2JhKCR7dGhpcy5yfSwgJHt0aGlzLmd9LCAke3RoaXMuYn0sICR7dGhpcy5hfSlgO1xuICAgICAgICByZXR1cm4gYHJnYigke3RoaXMucn0sICR7dGhpcy5nfSwgJHt0aGlzLmJ9KWBcbiAgICB9XG59XG4iXX0=
